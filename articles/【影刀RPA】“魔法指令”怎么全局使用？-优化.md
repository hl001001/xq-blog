# 【影刀RPA】“魔法指令”怎么全局使用？

### 需求背景
在一个应用中生成 **特殊需求 **的 **魔法指令**，只能在当前应用中复制粘贴重复使用，如果我后面又想开发一个新的应用。且我还需要用到之前生成这个 **特殊需求的魔法指令**，那我就得再生成一个，那就非常繁琐和麻烦了。那怎么解决这个问题？

### 解决
使用 **自定义指令 **进行封装发版，从而重复使用



### 具体步骤
#### 创建自定义指令
![](images/ydrpa_magic_1_1752549727344-5bc41f32-469c-417c-a3ae-a5eadaed0c1e.png)

#### 根据自己的特殊需求 生成魔法指令
###### 这是我的个人博客网站：[https://hl001001.github.io/](https://hl001001.github.io/)
![](images/ydrpa_magic_2_1752549883639-cb2c7860-3082-4193-81a8-5a9797f144b4.png)

#### 开始具体构建自定义指令
##### 点击魔法指令的 ”编辑源码“
![](images/ydrpa_magic_3_1752549918733-e350abf0-cedc-487b-ad07-0d10203f58f9.png)

##### 全选 复制里面的源码
![](images/ydrpa_magic_4_1752549996836-e35b87b0-5314-41b5-9175-407d43e352ed.png)

##### 关闭魔法指令窗口后，点击添加 Python模块
![](images/ydrpa_magic_5_1752550295082-2f4d0fad-534d-4a98-85ef-d532745006ca.png)

##### 然后直接全选粘贴刚刚复制的 源码
![](images/ydrpa_magic_6_1752550557184-6b6068b9-d6c0-43ce-9586-ea84a1f84305.png)

##### 在 主流程 中，使用”调用模块“指令调用 python模块
###### 调用模块 指令 编辑页面
![](images/ydrpa_magic_7_1752550729708-d066e26b-e748-44e8-8ddf-ac31b89279f3.png)

###### 参考魔法指令的流程参数
![](images/ydrpa_magic_8_1752550094530-bad411bb-0c9e-4437-94a0-1d8c6f753449.png)

###### 创建流程参数
![](images/ydrpa_magic_9_1752550925612-5586f014-9517-4ee2-8ff6-804b671c0aab.png)

###### 完整的 调用模块 指令编辑页面
![](images/ydrpa_magic_10_1752551079067-4f429e76-85cf-4579-b3b0-865d34828564.png)

##### 自定义指令现在就完成了
###### 最后的界面
![](images/ydrpa_magic_11_1752551118611-514e6bcf-7067-46f6-8675-fe0206196147.png)

###### 自定义指令的信息，注意目标网页、目标元素、替换的文本参数，也是可以拖动排序的
![](images/ydrpa_magic_12_1752551199140-b18ed3fd-2077-4df7-9628-368a4a479f95.png)

#### 发版（只要发版后，之后的应用就都可以用到自己编写的 自定义指令 了）
![](images/ydrpa_magic_13_1752553151519-7b03c686-aa02-4bf5-aa34-45fbb7578ee0.png)

#### 实际在应用中使用
![](images/ydrpa_magic_14_1752551481077-73debb09-2ac9-4ee5-9eb8-ea16db6acfbe.png)

### 关键点
##### 复制魔法指令源码、流程参数、调用模块指令
